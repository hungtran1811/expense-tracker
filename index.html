<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hưng Trần • ht</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./assets/app.css" />
  </head>
  <body>
    <div class="app-shell d-flex">
      <!-- Sidebar -->
      <aside class="sidebar d-flex flex-column position-fixed h-100">
        <a
          href="#dashboard"
          class="d-flex align-items-center mb-3 text-decoration-none"
        >
          <i class="bi bi-wallet2 me-2 fs-4 text-primary"></i>
          <span class="brand">Chi tiêu</span>
        </a>
        <hr class="border-secondary" />
        <ul class="nav nav-pills flex-column gap-1" id="sideNav">
          <li class="nav-item">
            <a class="nav-link" href="#dashboard"
              ><i class="bi bi-speedometer2"></i
              ><span class="label"> Tổng quan</span></a
            >
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#expenses"
              ><i class="bi bi-receipt"></i
              ><span class="label"> Chi tiêu</span></a
            >
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#add-expense"
              ><i class="bi bi-plus-circle"></i
              ><span class="label"> Thêm chi</span></a
            >
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#accounts"
              ><i class="bi bi-bank"></i
              ><span class="label"> Tài khoản</span></a
            >
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#reports"
              ><i class="bi bi-graph-up"></i
              ><span class="label"> Báo cáo</span></a
            >
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#ai"
              ><i class="bi bi-stars"></i
              ><span class="label"> AI hỗ trợ</span></a
            >
          </li>
          <!-- <li class="nav-item">
            <a class="nav-link" href="#settings"
              ><i class="bi bi-gear"></i><span class="label"> Cài đặt</span></a
            >
          </li> -->
        </ul>
        <!-- <hr class="border-secondary mt-auto" />
        <div class="d-flex align-items-center gap-2 p-2" id="userBox">
          <img
            class="avatar"
            src="https://i.pravatar.cc/100?img=68"
            alt="user"
          />
          <div>
            <div class="text-dark" id="displayName">Bạn H.</div>
            <div class="muted small" id="planLabel">Single user</div>
          </div>
        </div> -->
      </aside>

      <!-- Main -->
      <main class="content flex-grow-1">
        <nav class="navbar navbar-expand-lg sticky-top">
          <div class="container-fluid">
            <!-- NAV STATS: Chi / Thu tháng này (đặt ngay trước dropdown Tài khoản) -->
            <div
              id="navStats"
              class="d-flex align-items-center flex-wrap gap-2 me-2"
            >
              <span class="badge bg-light text-dark nav-stat">
                Chi: <strong id="navExpTotal">0đ</strong>
              </span>
              <span class="badge bg-light text-dark nav-stat">
                Thu: <strong id="navIncTotal">0đ</strong>
              </span>
            </div>

            <div class="ms-auto d-flex align-items-center gap-2">
              <button class="btn btn-outline-secondary" id="btnExportCsv">
                <i class="bi bi-cloud-arrow-up me-1"></i>Xuất CSV
              </button>
              <div class="dropdown">
                <button
                  class="btn btn-outline-secondary dropdown-toggle"
                  data-bs-toggle="dropdown"
                >
                  <i class="bi bi-person-circle me-1"></i
                  ><span id="authBtnLabel">Đăng nhập</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-end">
                  <li>
                    <a class="dropdown-item" href="#" id="btnSignIn"
                      >Đăng nhập Google</a
                    >
                  </li>
                  <li>
                    <a class="dropdown-item" href="#" id="btnSignOut"
                      >Đăng xuất</a
                    >
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </nav>

        <div class="container-fluid p-3 p-md-4">
          <!-- Dashboard -->
          <section id="dashboard" class="route active">
            <div class="row g-3">
              <div class="col-12 col-lg-4">
                <div class="card p-3">
                  <div class="d-flex justify-content-between align-items-start">
                    <h6 class="muted">Tổng chi tháng này</h6>
                    <span class="badge badge-soft" id="monthBadge"></span>
                  </div>
                  <h3 class="mt-2" id="totalThisMonth"></h3>
                  <p class="muted small" id="deltaMonth"></p>
                </div>
              </div>

              <div class="col-6 col-lg-4">
                <!-- Card số dư theo tài khoản -->
                <div class="card">
                  <div class="card-body">
                    <h6 class="card-title mb-2">Số dư theo tài khoản</h6>
                    <div id="balanceList" class="small">
                      <!-- renderBalancesList() sẽ đổ dữ liệu tại đây -->
                      <div class="text-muted">Chưa có dữ liệu</div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-6 col-lg-4">
                <div class="card p-3">
                  <!-- <h6 class="muted">Top danh mục</h6> -->
                  <!-- <div class="d-grid gap-2" id="topCats"> -->
                  <!-- injected by reports.js -->
                  <!-- </div> -->
                </div>
              </div>
            </div>
          </section>

          <!-- Expenses -->
          <section id="expenses" class="route">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h4 class="mb-0">Chi tiêu</h4>
              <div class="d-flex gap-2">
                <select
                  class="form-select"
                  style="max-width: 160px"
                  id="monthFilter"
                ></select>
              </div>
            </div>
            <div class="card p-3">
              <div class="table-responsive">
                <table
                  class="table table-hover align-middle"
                  id="expensesTable"
                >
                  <thead>
                    <tr>
                      <th>Ngày</th>
                      <th>Tên</th>
                      <th>Danh mục</th>
                      <th>Tài khoản</th>
                      <th>Số tiền</th>
                      <th class="text-end">Thao tác</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
          </section>

          <!-- Add Expense -->
          <section id="add-expense" class="route">
            <div class="row g-3">
              <div class="col-12 col-xl-8">
                <div class="card p-3">
                  <h4>Thêm chi tiêu</h4>
                  <div class="row g-3">
                    <div class="col-12">
                      <label class="form-label">Tên khoản chi</label>
                      <input
                        type="text"
                        class="form-control"
                        id="eName"
                        placeholder="Ví dụ: Coffee sáng"
                      />
                    </div>
                    <div class="col-6">
                      <label class="form-label">Số tiền</label>
                      <input
                        type="number"
                        class="form-control"
                        id="eAmount"
                        placeholder="0"
                      />
                    </div>
                    <div class="col-6">
                      <label class="form-label">Ngày</label>
                      <input type="date" class="form-control" id="eDate" />
                    </div>
                    <div class="col-6">
                      <label class="form-label">Danh mục</label>
                      <select class="form-select" id="eCategory">
                        <option>Ăn uống</option>
                        <option>Coffee</option>
                        <option>
                          Cá nhân (Đồ điện tử, quần áo, giày dép, cắt tóc, ...)
                        </option>
                        <option>Tiền nhà</option>
                        <option>Thể thao</option>
                        <option>Siêu thị</option>
                        <option>Xe cộ</option>
                        <option>Y tế</option>
                        <option>Cho mượn</option>
                        <option>Khác</option>
                      </select>
                    </div>
                    <div class="col-6">
                      <label class="form-label">Tài khoản</label>
                      <select class="form-select" id="eAccount">
                        <option>MSB</option>
                        <option>Sacombank</option>
                        <option>Túi thần tài MoMo</option>
                        <option>VPBank</option>
                      </select>
                    </div>
                    <div class="col-12">
                      <label class="form-label">Ghi chú</label>
                      <textarea
                        class="form-control"
                        id="eNote"
                        rows="2"
                        placeholder="Mô tả ngắn (tùy chọn)"
                      ></textarea>
                    </div>
                    <div class="col-12 d-flex justify-content-end gap-2">
                      <button class="btn btn-outline-secondary" id="btnDraft">
                        Lưu nháp
                      </button>
                      <button class="btn btn-primary" id="btnAddExpense">
                        Thêm
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-12 col-xl-4">
                <div class="card p-3">
                  <h5 class="card-title">Mẹo AI (demo)</h5>
                  <p class="muted small">
                    Gợi ý phân loại, ghi chú thông minh, nhận diện khoản định
                    kỳ.
                  </p>
                  <div class="d-flex gap-2 flex-wrap">
                    <button class="btn btn-sm btn-outline-secondary">
                      Phân loại tự động
                    </button>
                    <button class="btn btn-sm btn-outline-secondary">
                      Đánh dấu định kỳ
                    </button>
                    <button class="btn btn-sm btn-outline-secondary">
                      Gợi ý tài khoản
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Add Account Modal -->
          <div class="modal" id="addAccountModal" tabindex="-1">
            <div class="modal-dialog modal-md modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title">Thêm tài khoản</h5>
                  <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="modal"
                  ></button>
                </div>
                <div class="modal-body">
                  <div class="mb-2">
                    <label class="form-label">Tên tài khoản</label>
                    <input
                      class="form-control"
                      id="aName"
                      placeholder="VD: MSB, MoMo..."
                    />
                  </div>
                  <div class="mb-2">
                    <label class="form-label">Loại</label>
                    <select class="form-select" id="aType">
                      <option value="bank">Ngân hàng</option>
                      <option value="ewallet">Ví điện tử</option>
                      <option value="other">Khác</option>
                    </select>
                  </div>
                  <div class="form-check">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      id="aDefault"
                    />
                    <label class="form-check-label" for="aDefault"
                      >Đặt làm mặc định</label
                    >
                  </div>
                </div>
                <div class="modal-footer">
                  <button
                    class="btn btn-outline-secondary"
                    data-bs-dismiss="modal"
                  >
                    Huỷ
                  </button>
                  <button class="btn btn-primary" id="btnAddAccount">
                    Thêm
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Edit Account Modal -->
          <div class="modal" id="editAccountModal" tabindex="-1">
            <div class="modal-dialog modal-md modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title">Sửa tài khoản</h5>
                  <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="modal"
                  ></button>
                </div>
                <div class="modal-body">
                  <input type="hidden" id="eaId" />
                  <div class="mb-2">
                    <label class="form-label">Tên tài khoản</label>
                    <input class="form-control" id="eaName" />
                  </div>
                  <div class="mb-2">
                    <label class="form-label">Loại</label>
                    <select class="form-select" id="eaType">
                      <option value="bank">Ngân hàng</option>
                      <option value="ewallet">Ví điện tử</option>
                      <option value="other">Khác</option>
                    </select>
                  </div>
                  <div class="form-check">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      id="eaDefault"
                    />
                    <label class="form-check-label" for="eaDefault"
                      >Đặt làm mặc định</label
                    >
                  </div>
                </div>
                <div class="modal-footer">
                  <button
                    class="btn btn-outline-secondary"
                    data-bs-dismiss="modal"
                  >
                    Huỷ
                  </button>
                  <button class="btn btn-primary" id="btnSaveAccount">
                    Lưu
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Add Income Modal -->
          <div class="modal" id="addIncomeModal" tabindex="-1">
            <div class="modal-dialog modal-lg modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title">Thêm thu nhập</h5>
                  <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="modal"
                  ></button>
                </div>
                <div class="modal-body">
                  <div class="row g-3">
                    <div class="col-md-6">
                      <label class="form-label">Tên thu nhập</label>
                      <input
                        class="form-control"
                        id="iName"
                        placeholder="Lương, thưởng, refund..."
                      />
                    </div>
                    <div class="col-md-3">
                      <label class="form-label">Số tiền</label>
                      <input class="form-control" id="iAmount" type="number" />
                    </div>
                    <div class="col-md-3">
                      <label class="form-label">Ngày</label>
                      <input class="form-control" id="iDate" type="date" />
                    </div>
                    <div class="col-md-6">
                      <label class="form-label">Tài khoản</label>
                      <select class="form-select" id="iAccount">
                        <!-- Danh sách tài khoản sẽ tự đổ từ Firestore -->
                      </select>
                    </div>
                    <div class="col-12">
                      <label class="form-label">Ghi chú</label>
                      <textarea
                        class="form-control"
                        id="iNote"
                        rows="2"
                      ></textarea>
                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <button
                    class="btn btn-outline-secondary"
                    data-bs-dismiss="modal"
                  >
                    Huỷ
                  </button>
                  <button class="btn btn-primary" id="btnAddIncome">
                    Thêm
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Modal SỬA THU NHẬP -->
          <div class="modal fade" id="editIncomeModal" tabindex="-1">
            <div class="modal-dialog modal-lg modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title">Sửa thu nhập</h5>
                  <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="modal"
                  ></button>
                </div>
                <div class="modal-body">
                  <input type="hidden" id="eiId" />
                  <div class="row g-3">
                    <div class="col-md-6">
                      <label class="form-label">Tên thu nhập</label>
                      <input class="form-control" id="eiName" />
                    </div>
                    <div class="col-md-3">
                      <label class="form-label">Số tiền</label>
                      <input class="form-control" id="eiAmount" type="number" />
                    </div>
                    <div class="col-md-3">
                      <label class="form-label">Ngày</label>
                      <input class="form-control" id="eiDate" type="date" />
                    </div>
                    <div class="col-md-6">
                      <label class="form-label">Tài khoản</label>
                      <select class="form-select" id="eiAccount"></select>
                    </div>
                    <div class="col-12">
                      <label class="form-label">Ghi chú</label>
                      <textarea
                        class="form-control"
                        id="eiNote"
                        rows="2"
                      ></textarea>
                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <button
                    class="btn btn-outline-secondary"
                    data-bs-dismiss="modal"
                  >
                    Huỷ
                  </button>
                  <button class="btn btn-primary" id="btnSaveIncome">
                    Lưu thay đổi
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Accounts -->
          <section id="accounts" class="route">
            <div class="row g-3">
              <div class="col-12 col-xl-6">
                <div class="card p-3">
                  <!-- Thu nhập trong tháng (đặt NGAY DƯỚI card bảng Tài khoản) -->
                  <div class="card mt-3">
                    <div class="card-body">
                      <div
                        class="d-flex justify-content-between align-items-center mb-2"
                      >
                        <h6 class="mb-0">Thu nhập (tháng này)</h6>
                        <button
                          class="btn btn-outline-success btn-sm"
                          data-bs-toggle="modal"
                          data-bs-target="#transferModal"
                        >
                          ↔️ Chuyển tiền
                        </button>

                        <button
                          class="btn btn-outline-success btn-sm"
                          data-bs-toggle="modal"
                          data-bs-target="#addIncomeModal"
                        >
                          + Thêm thu nhập
                        </button>
                      </div>
                      <div class="table-responsive">
                        <table class="table align-middle" id="incomesTable">
                          <thead>
                            <tr>
                              <th>Ngày</th>
                              <th>Tên</th>
                              <th>Tài khoản</th>
                              <th>Số tiền</th>
                              <th class="text-end">Thao tác</th>
                            </tr>
                          </thead>
                          <tbody></tbody>
                          <!-- cần có -->
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-12 col-xl-6">
                <div class="card p-3">
                  <div
                    class="d-flex justify-content-between align-items-center"
                  >
                    <h5 class="mb-0">Tài khoản</h5>
                    <div class="d-flex justify-content-end mb-2">
                      <button
                        class="btn btn-primary btn-sm"
                        data-bs-toggle="modal"
                        data-bs-target="#addAccountModal"
                      >
                        + Thêm tài khoản
                      </button>
                    </div>
                  </div>
                  <table class="table align-middle" id="accountsTable">
                    <thead>
                      <tr>
                        <th>Tên</th>
                        <th>Loại</th>
                        <th>Mặc định</th>
                        <th class="text-end">Thao tác</th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                    <!-- PHẢI có tbody -->
                  </table>

                  <ul class="list-group list-group-flush" id="accountList"></ul>
                </div>
              </div>
            </div>
          </section>

          <!-- Reports -->
          <section id="reports" class="route">
            <div class="row g-3">
              <div class="col-12 col-xl-4">
                <div class="card p-3">
                  <h5>Bộ lọc</h5>
                  <div class="mb-3">
                    <label class="form-label">Khoảng thời gian</label>
                    <select class="form-select" id="rangeSelect">
                      <option>Tháng này</option>
                      <option>30 ngày gần đây</option>
                      <option>Tùy chọn</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Tài khoản</label>
                    <select class="form-select" id="accountSelect">
                      <option>Tất cả</option>
                      <option>MSB</option>
                      <option>Sacombank</option>
                      <option>Túi thần tài MoMo</option>
                      <option>VPBank</option>
                    </select>
                  </div>
                  <button class="btn btn-primary w-100" id="btnApplyReport">
                    Áp dụng
                  </button>
                </div>
              </div>
              <div class="col-12 col-xl-8">
                <div class="card p-3">
                  <h5>Tổng quan báo cáo</h5>
                  <div class="row g-3">
                    <div class="col-md-6">
                      <div class="p-3 rounded border" id="barChart">
                        Biểu đồ cột (demo)
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="p-3 rounded border" id="pieChart">
                        Biểu đồ tròn (demo)
                      </div>
                    </div>
                  </div>
                  <div class="mt-3">
                    <div class="table-responsive">
                      <table class="table" id="reportTable">
                        <thead>
                          <tr>
                            <th>Danh mục</th>
                            <th>Tổng</th>
                            <th>Tỉ lệ</th>
                          </tr>
                        </thead>
                        <tbody></tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- AI -->
          <section id="ai" class="route">
            <div class="card p-3">
              <div class="d-flex align-items-center justify-content-between">
                <h4 class="mb-0">AI hỗ trợ (demo UI)</h4>
                <div class="d-flex gap-2">
                  <span class="chip">Google AI Studio (Gemini)</span>
                  <span class="chip">Ngữ cảnh: Firestore</span>
                </div>
              </div>
              <hr />
              <div
                class="d-flex flex-column gap-2"
                id="chatArea"
                style="min-height: 220px"
              >
                <div class="chat-bubble bot">
                  Xin chào! Mình có thể giúp phân loại chi tiêu, gợi ý ngân
                  sách, cảnh báo vượt trần.
                </div>
              </div>
              <div class="sticky-actions mt-3">
                <div class="input-group">
                  <span class="input-group-text"
                    ><i class="bi bi-stars"></i
                  ></span>
                  <input
                    class="form-control"
                    id="aiInput"
                    placeholder="Ví dụ: Đề xuất ngân sách tháng sau cho Ăn uống + Coffee"
                  />
                  <button class="btn btn-primary" id="aiSend">Gửi</button>
                </div>
                <div class="mt-2 d-flex gap-2 flex-wrap">
                  <button class="btn btn-sm btn-outline-secondary">
                    Tóm tắt tháng
                  </button>
                  <button class="btn btn-sm btn-outline-secondary">
                    Tối ưu tài khoản
                  </button>
                  <button class="btn btn-sm btn-outline-secondary">
                    Dự báo chi tiêu
                  </button>
                  <button class="btn btn-sm btn-outline-secondary">
                    Cảnh báo vượt trần
                  </button>
                </div>
              </div>
            </div>
          </section>

          <!-- Settings -->
          <!-- <section id="settings" class="route">
            <div class="row g-3">
              <div class="col-12 col-xl-6">
                <div class="card p-3">
                  <h5>Tài khoản</h5>
                  <div class="mb-3">
                    <label class="form-label">Tên hiển thị</label>
                    <input
                      class="form-control"
                      id="inDisplayName"
                      placeholder="Bạn H."
                    />
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Email</label>
                    <input
                      class="form-control"
                      id="inEmail"
                      placeholder="you@example.com"
                      disabled
                    />
                  </div>
                  <button class="btn btn-primary" id="btnSaveProfile">
                    Lưu
                  </button>
                </div>
              </div>
              <div class="col-12 col-xl-6">
                <div class="card p-3">
                  <h5>Tùy chọn</h5>
                  <div class="form-check form-switch">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      id="notif"
                      checked
                    />
                    <label class="form-check-label" for="notif"
                      >Nhận thông báo vượt ngân sách</label
                    >
                  </div>
                </div>
              </div>
            </div>
          </section> -->
        </div>

        <!-- Mobile Footer -->
        <footer class="mobile-footer d-none">
          <div class="left">
            <i class="bi bi-wallet2"></i>
            <span class="muted">Tháng này:</span>
            <strong id="footerTotal">—</strong>
          </div>
          <div class="right">
            <a class="btn btn-outline-secondary btn-sm" href="#reports"
              ><i class="bi bi-graph-up"></i> Báo cáo</a
            >
            <a class="btn btn-primary btn-sm" href="#add-expense"
              ><i class="bi bi-plus"></i> Thêm</a
            >
          </div>
        </footer>
      </main>
    </div>

    <a href="#add-expense" class="btn btn-primary fab-add" title="Thêm nhanh"
      ><i class="bi bi-plus-lg"></i
    ></a>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="./assets/main.js"></script>
  </body>
</html>

<!-- Toast container (top-right) -->
<div
  class="toast-container position-fixed top-0 end-0 p-3"
  style="z-index: 1080"
>
  <div
    id="appToast"
    class="toast align-items-center border-0"
    role="alert"
    aria-live="assertive"
    aria-atomic="true"
  >
    <div class="d-flex">
      <div class="toast-body">Đã thực hiện xong</div>
      <button
        type="button"
        class="btn-close me-2 m-auto"
        data-bs-dismiss="toast"
        aria-label="Close"
      ></button>
    </div>
  </div>
</div>

<!-- Add Account Modal -->
<div class="modal" id="addAccountModal" tabindex="-1">
  <div class="modal-dialog modal-md modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Thêm tài khoản</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
        ></button>
      </div>
      <div class="modal-body">
        <div class="mb-2">
          <label class="form-label">Tên tài khoản</label>
          <input class="form-control" id="aName" />
        </div>
        <div class="mb-2">
          <label class="form-label">Loại</label>
          <select class="form-select" id="aType">
            <option value="bank">Ngân hàng</option>
            <option value="ewallet">Ví điện tử</option>
            <option value="other">Khác</option>
          </select>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="aDefault" />
          <label class="form-check-label" for="aDefault"
            >Đặt làm mặc định</label
          >
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline-secondary" data-bs-dismiss="modal">
          Huỷ
        </button>
        <button class="btn btn-primary" id="btnAddAccount">Thêm</button>
      </div>
    </div>
  </div>
</div>

<!-- Edit Account Modal -->
<div class="modal" id="editAccountModal" tabindex="-1">
  <div class="modal-dialog modal-md modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Sửa tài khoản</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
        ></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="eaId" />
        <div class="mb-2">
          <label class="form-label">Tên tài khoản</label>
          <input class="form-control" id="eaName" />
        </div>
        <div class="mb-2">
          <label class="form-label">Loại</label>
          <select class="form-select" id="eaType">
            <option value="bank">Ngân hàng</option>
            <option value="ewallet">Ví điện tử</option>
            <option value="other">Khác</option>
          </select>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="eaDefault" />
          <label class="form-check-label" for="eaDefault"
            >Đặt làm mặc định</label
          >
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline-secondary" data-bs-dismiss="modal">
          Huỷ
        </button>
        <button class="btn btn-primary" id="btnSaveAccount">Lưu</button>
      </div>
    </div>
  </div>
</div>

<!-- Add Income Modal -->
<div class="modal" id="addIncomeModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Thêm thu nhập</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
        ></button>
      </div>
      <div class="modal-body">
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">Tên thu nhập</label>
            <input
              class="form-control"
              id="iName"
              placeholder="Lương, dạy thêm, refund..."
            />
          </div>
          <div class="col-md-3">
            <label class="form-label">Số tiền</label>
            <input class="form-control" id="iAmount" type="number" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Ngày</label>
            <input class="form-control" id="iDate" type="date" />
          </div>
          <div class="col-md-6">
            <label class="form-label">Tài khoản</label>
            <select class="form-select" id="iAccount"></select>
          </div>
          <div class="col-12">
            <label class="form-label">Ghi chú</label>
            <textarea class="form-control" id="iNote" rows="2"></textarea>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline-secondary" data-bs-dismiss="modal">
          Huỷ
        </button>
        <button class="btn btn-primary" id="btnAddIncome">Thêm</button>
      </div>
    </div>
  </div>
</div>

<!-- Edit Income Modal -->
<div class="modal" id="editIncomeModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Sửa thu nhập</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
        ></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="eiId" />
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">Tên thu nhập</label>
            <input class="form-control" id="eiName" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Số tiền</label>
            <input class="form-control" id="eiAmount" type="number" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Ngày</label>
            <input class="form-control" id="eiDate" type="date" />
          </div>
          <div class="col-md-6">
            <label class="form-label">Tài khoản</label>
            <select class="form-select" id="eiAccount"></select>
          </div>
          <div class="col-12">
            <label class="form-label">Ghi chú</label>
            <textarea class="form-control" id="eiNote" rows="2"></textarea>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline-secondary" data-bs-dismiss="modal">
          Huỷ
        </button>
        <button class="btn btn-primary" id="eiSave">Lưu thay đổi</button>
      </div>
    </div>
  </div>
</div>

<!-- Transfer Modal -->
<div class="modal fade" id="transferModal" tabindex="-1">
  <div class="modal-dialog modal-md modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Chuyển tiền giữa tài khoản</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
        ></button>
      </div>
      <div class="modal-body">
        <div class="mb-2">
          <label class="form-label">Từ tài khoản</label>
          <select class="form-select" id="tfFrom"></select>
        </div>
        <div class="mb-2">
          <label class="form-label">Đến tài khoản</label>
          <select class="form-select" id="tfTo"></select>
        </div>
        <div class="row g-2">
          <div class="col-6">
            <label class="form-label">Số tiền</label>
            <input
              type="number"
              class="form-control"
              id="tfAmount"
              min="0"
              step="1000"
            />
          </div>
          <div class="col-6">
            <label class="form-label">Ngày</label>
            <input type="date" class="form-control" id="tfDate" />
          </div>
        </div>
        <div class="mt-2">
          <label class="form-label">Ghi chú</label>
          <input
            class="form-control"
            id="tfNote"
            placeholder="Ví dụ: rút tiết kiệm sang MSB"
          />
        </div>
        <div class="form-text mt-2">
          * Chuyển tiền không làm thay đổi tổng Chi/Thu; chỉ ảnh hưởng Số dư
          theo tài khoản.
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline-secondary" data-bs-dismiss="modal">
          Huỷ
        </button>
        <button class="btn btn-primary" id="btnDoTransfer">Chuyển</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal SỬA TÀI KHOẢN -->
<div class="modal fade" id="editAccountModal" tabindex="-1">
  <div class="modal-dialog modal-md modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Sửa tài khoản</h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="eaId" />
        <div class="mb-2">
          <label class="form-label">Tên</label>
          <input id="eaName" class="form-control" />
        </div>
        <div class="mb-2">
          <label class="form-label">Loại</label>
          <select id="eaType" class="form-select">
            <option value="bank">Ngân hàng</option>
            <option value="ewallet">Ví điện tử</option>
            <option value="other">Khác</option>
          </select>
        </div>
        <div class="form-check">
          <input id="eaDefault" class="form-check-input" type="checkbox" />
          <label class="form-check-label" for="eaDefault"
            >Đặt làm mặc định</label
          >
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline-secondary" data-bs-dismiss="modal">
          Huỷ
        </button>
        <button class="btn btn-primary" id="btnSaveAccount">Lưu</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal XOÁ TÀI KHOẢN (chuyển giao giao dịch) -->
<div class="modal fade" id="deleteAccountModal" tabindex="-1">
  <div class="modal-dialog modal-md modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Xoá tài khoản</h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="daId" />
        <div class="alert alert-warning small">
          Tất cả <b>Chi tiêu</b>, <b>Thu nhập</b> và <b>Chuyển tiền</b> dùng tài
          khoản này sẽ được <b>chuyển sang</b> tài khoản khác trước khi xoá.
        </div>
        <label class="form-label">Chuyển sang tài khoản</label>
        <select id="daTarget" class="form-select"></select>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline-secondary" data-bs-dismiss="modal">
          Huỷ
        </button>
        <button class="btn btn-danger" id="btnConfirmDeleteAccount">
          Chuyển & xoá
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Edit Expense Modal -->
<div class="modal fade" id="editExpenseModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Sửa chi tiêu</h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="edId" />
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">Tên</label>
            <input id="edName" class="form-control" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Số tiền</label>
            <input id="edAmount" type="number" class="form-control" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Ngày</label>
            <input id="edDate" type="date" class="form-control" />
          </div>
          <div class="col-md-6">
            <label class="form-label">Danh mục</label>
            <select id="edCategory" class="form-select">
              <option>Ăn uống</option>
              <option>Coffee</option>
              <option>
                Cá nhân (Đồ điện tử, quần áo, giày dép, cắt tóc, ...)
              </option>
              <option>Tiền nhà</option>
              <option>Thể thao</option>
              <option>Siêu thị</option>
              <option>Xe cộ</option>
              <option>Y tế</option>
              <option>Cho mượn</option>
              <option>Khác</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">Tài khoản</label>
            <select id="edAccount" class="form-select"></select>
          </div>
          <div class="col-12">
            <label class="form-label">Ghi chú</label>
            <textarea id="edNote" rows="2" class="form-control"></textarea>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline-secondary" data-bs-dismiss="modal">
          Huỷ
        </button>
        <button class="btn btn-primary" id="btnSaveExpense">
          Lưu thay đổi
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Confirm Delete Expense -->
<div class="modal fade" id="confirmDeleteModal" tabindex="-1">
  <div class="modal-dialog modal-sm modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title">Xoá khoản chi?</h6>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <p class="mb-0">Hành động này không thể hoàn tác.</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline-secondary" data-bs-dismiss="modal">
          Huỷ
        </button>
        <button class="btn btn-danger" id="btnConfirmDelete">Xoá</button>
      </div>
    </div>
  </div>
</div>
