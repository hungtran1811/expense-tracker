<!doctype html>
<html lang="vi" data-i18n-ready="false">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>NEXUS OS</title>
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon_32.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&family=Space+Grotesk:wght@500;600;700&display=swap"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <style>
      html[data-i18n-ready="false"] body {
        opacity: 0;
      }
      body {
        transition: opacity 0.12s ease;
      }
    </style>
  </head>
  <body>
    <div class="app-shell">
      <aside class="nav-rail" id="navRail">
        <a class="brand" href="#dashboard" aria-label="NEXUS OS">
          <img src="/img/favicon_64.png" alt="NEXUS OS" />
          <span class="brand-text">NEXUS OS</span>
        </a>

        <nav class="rail-nav">
          <a href="#dashboard" class="rail-link" data-nav="dashboard" aria-label="Trung tâm">
            <i class="bi bi-grid-1x2"></i>
            <span class="rail-label">Trung tâm</span>
          </a>
          <a href="#expenses" class="rail-link" data-nav="expenses" aria-label="Chi tiêu">
            <i class="bi bi-receipt-cutoff"></i>
            <span class="rail-label">Chi tiêu</span>
          </a>
          <a href="#goals" class="rail-link" data-nav="goals" aria-label="Mục tiêu">
            <i class="bi bi-bullseye"></i>
            <span class="rail-label">Mục tiêu</span>
          </a>
          <a href="#video-plan" class="rail-link" data-nav="video-plan" aria-label="Kế hoạch video">
            <i class="bi bi-camera-video"></i>
            <span class="rail-label">Video</span>
          </a>
          <a href="#weekly-review" class="rail-link" data-nav="weekly-review" aria-label="Tổng kết tuần">
            <i class="bi bi-calendar-week"></i>
            <span class="rail-label">Tổng kết</span>
          </a>
          <a href="#accounts" class="rail-link" data-nav="accounts" aria-label="Tài khoản">
            <i class="bi bi-wallet2"></i>
            <span class="rail-label">Tài khoản</span>
          </a>
          <a href="#settings" class="rail-link" data-nav="settings" aria-label="Cài đặt">
            <i class="bi bi-gear"></i>
            <span class="rail-label">Cài đặt</span>
          </a>
        </nav>

        <div class="rail-footer">
          <small>Hưng Trần</small>
        </div>
      </aside>

      <div id="sidebarBackdrop" class="rail-backdrop d-lg-none"></div>

      <div class="app-frame">
        <header class="topbar">
          <div class="topbar-left">
            <button
              type="button"
              class="btn btn-icon d-lg-none"
              id="btnSidebarToggle"
              aria-label="Mở điều hướng"
            >
              <i class="bi bi-list"></i>
            </button>

            <div class="topbar-title">
              <div class="title">Trung tâm</div>
              <div class="subtitle">Tổng quan tài chính, mục tiêu và video</div>
            </div>
          </div>

          <div class="topbar-center">
            <div class="month-filter">
              <label for="monthFilter" class="form-label small">Tháng</label>
              <select class="form-select form-select-sm" id="monthFilter"></select>
            </div>
          </div>

          <div class="topbar-right">
            <div id="navStats" class="topbar-stats">
              <span class="stat-pill">Chi <strong id="navExpTotal">0</strong></span>
              <span class="stat-pill">Thu <strong id="navIncTotal">0</strong></span>
            </div>

            <button class="btn btn-outline-primary btn-sm" id="btnExportCsv">
              <i class="bi bi-download"></i>
              Xuất CSV
            </button>

            <div class="btn-group">
              <button
                type="button"
                class="btn btn-secondary btn-sm dropdown-toggle"
                data-bs-toggle="dropdown"
                aria-expanded="false"
                id="btnUserMenu"
              >
                <i class="bi bi-person-circle"></i>
                <span id="userNameLabel">Khách</span>
              </button>
              <ul class="dropdown-menu dropdown-menu-end">
                <li id="menu-login">
                  <button class="dropdown-item" id="btnLoginGoogle">Đăng nhập Google</button>
                </li>
                <li id="menu-logout" class="d-none">
                  <button class="dropdown-item" id="btnLogout">Đăng xuất</button>
                </li>
              </ul>
            </div>
          </div>
        </header>

        <main class="content">
          <div class="container-fluid p-3 p-md-4">
            <section id="auth" class="route">
              <div class="row justify-content-center">
                <div class="col-12 col-md-8 col-lg-5">
                  <div class="card auth-card p-4 p-md-5 text-center">
                    <img src="/img/logo_256.png" alt="NEXUS OS" class="auth-logo mb-3" />
                    <h3 class="mb-2">Chào mừng trở lại, Hưng</h3>
                    <p class="text-muted mb-4">
                      Đăng nhập Google để vào hệ thống quản lý chi tiêu, mục tiêu và kế hoạch video.
                    </p>
                    <button class="btn btn-primary btn-lg" id="btnLoginGoogleInline">
                      <i class="bi bi-google me-2"></i>
                      Đăng nhập với Google
                    </button>
                  </div>
                </div>
              </div>
            </section>

                        <section id="dashboard" class="route active">
              <div class="dashboard-command-center d-grid gap-3">
                <div class="card dashboard-hero p-3 p-md-4">
                  <div class="dash-hero-head d-flex justify-content-between align-items-start flex-wrap gap-3">
                    <div class="dash-hero-copy">
                      <span class="badge badge-soft mb-2" id="monthBadge">--/----</span>
                      <h4 class="mb-1" id="dashGreeting">Chào buổi sáng, Hưng</h4>
                      <p class="text-muted mb-0" id="dashHeroTagline">
                        Tập trung tạo video chất lượng và kiểm soát tài chính bền vững.
                      </p>
                    </div>
                    <div class="dash-hero-actions">
                      <div class="small text-muted mb-2" id="dashQuickTitle">Hành động nhanh</div>
                      <div class="d-flex flex-wrap gap-2">
                        <button
                          class="btn btn-primary btn-sm"
                          id="btnQuickAddExpense"
                          data-bs-toggle="offcanvas"
                          data-bs-target="#addExpenseModal"
                        >
                          + Thêm khoản chi
                        </button>
                        <a class="btn btn-outline-primary btn-sm" id="btnQuickGoGoals" href="#goals">Mở mục tiêu hôm nay</a>
                        <a class="btn btn-outline-primary btn-sm" id="btnQuickGoVideo" href="#video-plan">Mở bảng video</a>
                        <a class="btn btn-outline-primary btn-sm" id="btnQuickGoWeeklyReview" href="#weekly-review">Tổng kết tuần</a>
                        <button class="btn btn-outline-success btn-sm d-none" id="btnDashQuickCheckIn">Điểm danh ngay</button>
                        <button class="btn btn-outline-primary btn-sm d-none" id="btnDashQuickDeadline">Mở việc cận hạn</button>
                      </div>
                    </div>
                  </div>

                  <div class="dash-hero-mission mt-3">
                    <div class="small text-uppercase text-muted" id="dashMissionTitle">Nhiệm vụ hôm nay</div>
                    <p class="mb-2" id="dashMissionText">
                      Hoàn thành 1 mục tiêu và đẩy 1 công việc video tiến lên trong hôm nay.
                    </p>
                    <div class="small text-muted" id="dashHeroMeta">Trạng thái theo thời gian thực của tháng đang chọn</div>
                  </div>

                  <div class="dash-priority mt-3">
                    <div class="d-flex justify-content-between align-items-center gap-2 mb-2">
                      <div class="small text-uppercase text-muted" id="dashPriorityTitle">Ưu tiên hôm nay</div>
                      <a href="#video-plan" id="dashPriorityLink" class="small text-decoration-none">Mở kế hoạch video</a>
                    </div>
                    <div id="dashPriorityList" class="dash-priority-list"></div>
                  </div>

                  <div class="dash-hero-kpis mt-3">
                    <article class="dash-hero-kpi">
                      <small>Việc video đang mở</small>
                      <strong id="dashHeroVideoCount">0</strong>
                    </article>
                    <article class="dash-hero-kpi">
                      <small>Lượt thói quen còn lại</small>
                      <strong id="dashHeroHabitCount">0</strong>
                    </article>
                    <article class="dash-hero-kpi">
                      <small>Mục tiêu đang chạy</small>
                      <strong id="dashHeroGoalCount">0</strong>
                    </article>
                  </div>
                </div>

                <div class="card p-3 dashboard-action-board" id="dashActionBoard">
                  <div class="d-flex justify-content-between align-items-start flex-wrap gap-2 mb-2">
                    <div>
                      <h6 class="mb-1" id="dashActionBoardTitle">Bảng hành động hôm nay</h6>
                      <p class="text-muted small mb-0" id="dashActionBoardSub">
                        Tập trung vào việc kế tiếp và các công việc video cận hạn 72 giờ.
                      </p>
                    </div>
                    <div id="dashReminderBadges" class="dash-reminder-badges"></div>
                  </div>
                  <div class="row g-3 dash-action-grid">
                    <div class="col-12 col-xl-5">
                      <div class="dash-action-col h-100">
                        <div class="small text-uppercase text-muted mb-2" id="dashNextActionsTitle">Việc kế tiếp</div>
                        <div id="dashNextActions" class="dash-action-list"></div>
                      </div>
                    </div>
                    <div class="col-12 col-xl-4">
                      <div class="dash-action-col h-100">
                        <div class="small text-uppercase text-muted mb-2" id="dashDeadline72hTitle">Cận hạn 72 giờ</div>
                        <div id="dashDeadline72h" class="dash-deadline-list"></div>
                      </div>
                    </div>
                    <div class="col-12 col-xl-3">
                      <div class="dash-action-col h-100">
                        <div class="small text-uppercase text-muted mb-2" id="dashActionSummaryTitle">Tóm tắt hành động</div>
                        <div id="dashActionSummary" class="dash-action-summary text-muted small"></div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row g-3 dashboard-grid">
                  <div class="col-12 col-xxl-4">
                    <div class="card h-100 p-3 dashboard-summary-card">
                      <div class="d-flex justify-content-between align-items-center mb-2 gap-2">
                        <div>
                          <h6 class="mb-0">Số dư tài khoản</h6>
                          <div class="small text-muted">Theo dõi dòng tiền theo từng ví/tài khoản.</div>
                        </div>
                        <a href="#accounts" class="small text-decoration-none">Xem chi tiết</a>
                      </div>
                      <div id="dashboardAccountBalances" class="small"></div>
                    </div>
                  </div>

                  <div class="col-12 col-xxl-8">
                    <div class="card h-100 p-3 dashboard-summary-card">
                      <div class="d-flex justify-content-between align-items-center mb-2 gap-2">
                        <div>
                          <h6 class="mb-0">Luồng video tuần này</h6>
                          <div class="small text-muted" id="dashVideoPipelineSub"></div>
                        </div>
                        <div class="d-flex align-items-center gap-2">
                          <span class="badge text-bg-primary" id="dashVideoCountBadge">0</span>
                          <a href="#video-plan" class="small text-decoration-none">Mở bảng</a>
                        </div>
                      </div>
                      <div id="dashboardVideoSummary"></div>
                    </div>
                  </div>

                  <div class="col-12 col-lg-6 col-xxl-6">
                    <div class="card h-100 p-3 dashboard-summary-card">
                      <div class="d-flex justify-content-between align-items-center mb-2 gap-2">
                        <div>
                          <h6 class="mb-0">Mục tiêu đang chạy</h6>
                          <div class="small text-muted" id="dashGoalsSub"></div>
                        </div>
                        <div class="d-flex align-items-center gap-2">
                          <span class="badge text-bg-primary" id="dashGoalsCountBadge">0</span>
                          <a href="#goals" class="small text-decoration-none">Mở chi tiết</a>
                        </div>
                      </div>
                      <div id="dashboardGoalsSummary"></div>
                    </div>
                  </div>

                  <div class="col-12 col-lg-6 col-xxl-6">
                    <div class="card h-100 p-3 dashboard-summary-card">
                      <div class="d-flex justify-content-between align-items-center mb-2 gap-2">
                        <div>
                          <h6 class="mb-0">Động lực</h6>
                          <div class="small text-muted" id="dashMotivationSub"></div>
                        </div>
                        <a href="#goals" class="small text-decoration-none">Xem thử thách</a>
                      </div>
                      <div id="dashboardMotivation"></div>
                    </div>
                  </div>

                </div>
              </div>
            </section>

            <section id="weekly-review" class="route">
              <div class="page-header">
                <div>
                  <h4 class="mb-1" id="wrHeaderTitle">Tổng kết tuần</h4>
                  <p class="text-muted small mb-0" id="wrHeaderSubtitle">
                    Nghi thức review cuối tuần để ra quyết định nhanh cho tuần mới.
                  </p>
                </div>
                <div class="page-actions">
                  <button class="btn btn-primary" id="btnWeeklyReviewSave">Lưu tổng kết tuần</button>
                </div>
              </div>

              <div class="weekly-review-meta d-flex flex-wrap justify-content-between align-items-center gap-2 mb-3">
                <div class="small fw-semibold" id="wrWeekLabel">Tuần hiện tại</div>
                <div class="small text-muted" id="wrSaveStatus">Sẵn sàng tổng kết tuần</div>
              </div>

              <div class="row g-3 weekly-review-grid">
                <div class="col-12 col-md-6 col-xl-3">
                  <div class="card p-3 h-100">
                    <h6 class="mb-2" id="wrFinanceTitle">Tài chính tuần</h6>
                    <div id="wrFinanceSnapshot" class="small"></div>
                  </div>
                </div>
                <div class="col-12 col-md-6 col-xl-3">
                  <div class="card p-3 h-100">
                    <h6 class="mb-2" id="wrGoalsTitle">Mục tiêu &amp; thói quen</h6>
                    <div id="wrGoalsSnapshot" class="small"></div>
                  </div>
                </div>
                <div class="col-12 col-md-6 col-xl-3">
                  <div class="card p-3 h-100">
                    <h6 class="mb-2" id="wrVideoTitle">Video tuần này</h6>
                    <div id="wrVideoSnapshot" class="small"></div>
                  </div>
                </div>
                <div class="col-12 col-md-6 col-xl-3">
                  <div class="card p-3 h-100">
                    <h6 class="mb-2" id="wrMotivationTitle">Động lực tuần</h6>
                    <div id="wrMotivationSnapshot" class="small"></div>
                  </div>
                </div>
              </div>

              <div class="row g-3 mt-1">
                <div class="col-12">
                  <div class="card p-3 h-100">
                    <h6 class="mb-2" id="wrVideoPerformanceTitle">Hiệu suất video tuần</h6>
                    <div id="wrVideoPerformanceSnapshot" class="small"></div>
                    <div class="small text-muted mt-2" id="wrVideoInsight"></div>
                  </div>
                </div>
              </div>

              <div class="row g-3 mt-1">
                <div class="col-12 col-xl-8">
                  <div class="card p-3">
                    <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-2">
                      <h6 class="mb-0" id="wrPlanTitle">Kế hoạch tuần mới</h6>
                    </div>
                    <div class="row g-3">
                      <div class="col-12">
                        <label class="form-label" for="wrFocusTheme" id="wrLabelFocusTheme">Chủ đề trọng tâm</label>
                        <input
                          id="wrFocusTheme"
                          type="text"
                          class="form-control"
                          placeholder="Ví dụ: Chốt lịch quay 2 video và tối ưu chi phí sản xuất"
                        />
                      </div>
                      <div class="col-12 col-md-4">
                        <label class="form-label" for="wrTopPriority1" id="wrLabelTopPriority1">Ưu tiên 1</label>
                        <input id="wrTopPriority1" type="text" class="form-control" />
                      </div>
                      <div class="col-12 col-md-4">
                        <label class="form-label" for="wrTopPriority2" id="wrLabelTopPriority2">Ưu tiên 2</label>
                        <input id="wrTopPriority2" type="text" class="form-control" />
                      </div>
                      <div class="col-12 col-md-4">
                        <label class="form-label" for="wrTopPriority3" id="wrLabelTopPriority3">Ưu tiên 3</label>
                        <input id="wrTopPriority3" type="text" class="form-control" />
                      </div>
                      <div class="col-12 col-md-6">
                        <label class="form-label" for="wrRiskNote" id="wrLabelRiskNote">Rủi ro cần lưu ý</label>
                        <textarea id="wrRiskNote" class="form-control" rows="3"></textarea>
                      </div>
                      <div class="col-12 col-md-6">
                        <label class="form-label" for="wrActionCommitments" id="wrLabelActionCommitments">
                          Cam kết hành động
                        </label>
                        <textarea id="wrActionCommitments" class="form-control" rows="3"></textarea>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-12 col-xl-4">
                  <div class="card p-3">
                    <h6 class="mb-2" id="wrHistoryTitle">Lịch sử review gần đây</h6>
                    <div id="wrHistoryList"></div>
                  </div>
                </div>
              </div>
            </section>

            <section id="expenses" class="route">
              <div class="page-header">
                <div>
                  <h4 class="mb-1">Chi tiêu</h4>
                  <p id="expenseFilterInfo" class="text-muted small mb-0">
                    Hiển thị toàn bộ giao dịch chi tiêu trong tháng.
                  </p>
                </div>
                <div class="page-actions">
                  <button class="btn btn-primary" data-bs-toggle="offcanvas" data-bs-target="#addExpenseModal">
                    + Thêm khoản chi
                  </button>
                </div>
              </div>

              <div class="filters-row" id="expenseFilters">
                <select class="form-select form-select-sm" id="filterCategory">
                  <option value="all">Tất cả danh mục</option>
                </select>
                <select class="form-select form-select-sm" id="filterAccount">
                  <option value="all">Tất cả tài khoản</option>
                </select>
                <input
                  type="search"
                  class="form-control form-control-sm"
                  id="filterSearch"
                  placeholder="Tìm theo tên hoặc ghi chú..."
                />
              </div>

              <div class="card p-3 expenses-table-card">
                <div class="table-responsive">
                  <table class="table table-hover align-middle tx-table tx-table-mobile" id="expensesTable">
                    <thead>
                      <tr>
                        <th>Ngày</th>
                        <th>Giao dịch</th>
                        <th>Danh mục</th>
                        <th>Tài khoản</th>
                        <th class="text-end">Số tiền</th>
                        <th class="text-end">Thao tác</th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>
              </div>
            </section>

            <section id="goals" class="route">
              <div class="page-header">
                <div>
                  <h4 class="mb-1">Mục tiêu &amp; Động lực</h4>
                  <p class="text-muted small mb-0">
                    Theo dõi mục tiêu, thói quen và điểm XP theo ngày, tuần, tháng.
                  </p>
                </div>
              </div>

              <div class="goals-tier goals-tier-kpi">
                <div class="card p-3 goals-kpi-card">
                  <div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-2">
                    <h6 class="mb-0">Bảng điều khiển động lực</h6>
                    <span class="badge text-bg-light">Cập nhật theo kỳ hiện tại</span>
                  </div>
                  <div class="motivation-inline goals-kpi-progress">
                    <div class="motivation-inline-item">
                      <small>Thử thách ngày</small>
                      <strong id="challengeDayValue">0/0 (0%)</strong>
                    </div>
                    <div class="motivation-inline-item">
                      <small>Thử thách tuần</small>
                      <strong id="challengeWeekValue">0/0 (0%)</strong>
                    </div>
                    <div class="motivation-inline-item">
                      <small>Thử thách tháng</small>
                      <strong id="challengeMonthValue">0/0 (0%)</strong>
                    </div>
                  </div>
                  <div class="motivation-inline goals-kpi-stats mt-2">
                    <div class="motivation-inline-item">
                      <small>Chuỗi ngày</small>
                      <strong id="streakValue">0</strong>
                    </div>
                    <div class="motivation-inline-item">
                      <small>Tổng XP</small>
                      <strong id="totalXpValue">0</strong>
                    </div>
                    <div class="motivation-inline-item">
                      <small>Cấp độ</small>
                      <strong id="levelValue">1</strong>
                    </div>
                  </div>
                </div>
              </div>
              <div class="goals-tier goals-tier-focus mt-1">
                <div class="card p-3">
                  <div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-2">
                    <div>
                      <h6 class="mb-1">Hôm nay cần làm gì</h6>
                      <p class="small text-muted mb-0" id="goalsChallengeLabel">Ưu tiên các thói quen còn thiếu quota để giữ chuỗi ngày.</p>
                    </div>
                  </div>
                  <div id="goalsDailyFocus"></div>
                </div>
              </div>

              <div class="goals-tier goals-tier-forms row g-3 mt-1">
                <div class="col-12 col-xl-6">
                  <div class="card p-3 h-100">
                    <div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-3">
                      <h6 class="mb-0">Tạo mục tiêu mới</h6>
                      <div class="d-flex flex-wrap gap-2">
                        <button class="btn btn-outline-primary btn-sm" id="btnGoalAiGenerate">AI gợi ý mới</button>
                        <button class="btn btn-outline-secondary btn-sm" id="btnGoalAiImprove">AI cải thiện nội dung</button>
                      </div>
                    </div>
                    <div class="row g-2">
                      <div class="col-12 col-md-6">
                        <label class="form-label">Tên mục tiêu</label>
                        <input id="goalTitle" class="form-control" placeholder="Ví dụ: Quay máy quay mới" />
                      </div>
                      <div class="col-6 col-md-3">
                        <label class="form-label">Lĩnh vực</label>
                        <select id="goalArea" class="form-select">
                          <option value="ca-nhan">Cá nhân</option>
                          <option value="tai-chinh">Tài chính</option>
                          <option value="youtube">YouTube</option>
                          <option value="suc-khoe">Sức khỏe</option>
                        </select>
                      </div>
                      <div class="col-6 col-md-3">
                        <label class="form-label">Chu kỳ</label>
                        <select id="goalPeriod" class="form-select">
                          <option value="day">Ngày</option>
                          <option value="week">Tuần</option>
                          <option value="month" selected>Tháng</option>
                        </select>
                      </div>
                      <div class="col-6 col-md-3">
                        <label class="form-label">Mục tiêu</label>
                        <input id="goalTarget" type="number" min="1" class="form-control" value="1" />
                      </div>
                      <div class="col-6 col-md-3">
                        <label class="form-label">Đơn vị</label>
                        <input id="goalUnit" class="form-control" value="lần" />
                      </div>
                      <div class="col-6 col-md-3">
                        <label class="form-label">Hạn chót</label>
                        <input id="goalDueDate" type="date" class="form-control" />
                      </div>
                      <div class="col-6 col-md-3">
                        <label class="form-label">Ưu tiên</label>
                        <select id="goalPriority" class="form-select">
                          <option value="low">Thấp</option>
                          <option value="medium" selected>Vừa</option>
                          <option value="high">Cao</option>
                        </select>
                      </div>
                      <div class="col-12">
                        <label class="form-label">Ghi chú</label>
                        <textarea id="goalNote" class="form-control" rows="2" placeholder="Mô tả mục tiêu rõ ràng"></textarea>
                      </div>
                      <div class="col-12 d-flex justify-content-end">
                        <button class="btn btn-primary" id="btnAddGoal">Thêm mục tiêu</button>
                      </div>
                    </div>
                    <div id="goalAiSuggestionList" class="ai-suggestion-list mt-3"></div>
                  </div>
                </div>

                <div class="col-12 col-xl-6">
                  <div class="card p-3 h-100">
                    <h6 class="mb-3">Tạo thói quen mới</h6>
                    <div class="row g-2">
                      <div class="col-12">
                        <label class="form-label">Tên thói quen</label>
                        <input id="habitName" class="form-control" placeholder="Ví dụ: Viết kịch bản 30 phút" />
                      </div>
                      <div class="col-6">
                        <label class="form-label">Chu kỳ</label>
                        <select id="habitPeriod" class="form-select">
                          <option value="day" selected>Ngày</option>
                          <option value="week">Tuần</option>
                          <option value="month">Tháng</option>
                        </select>
                      </div>
                      <div class="col-6">
                        <label class="form-label">Số lần mục tiêu</label>
                        <input id="habitTarget" type="number" min="1" value="1" class="form-control" />
                      </div>
                      <div class="col-6">
                        <label class="form-label">XP mỗi check-in</label>
                        <input id="habitXp" type="number" min="1" value="10" class="form-control" />
                      </div>
                      <div class="col-12 d-flex justify-content-end">
                        <button class="btn btn-outline-primary" id="btnAddHabit">Thêm thói quen</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="goals-tier goals-tier-tracking row g-3 mt-1">
                <div class="col-12">
                  <div class="card p-3">
                    <div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-2">
                      <h6 class="mb-0">Theo dõi mục tiêu</h6>
                      <span class="small text-muted">Mục tiêu đạt đủ sẽ tự động khóa thao tác</span>
                    </div>
                    <div class="table-responsive">
                      <table class="table align-middle tx-table" id="goalsTable">
                        <thead>
                          <tr>
                            <th>Mục tiêu</th>
                            <th>Lĩnh vực</th>
                            <th>Chu kỳ</th>
                            <th>Tiến độ</th>
                            <th>Cập nhật</th>
                            <th>Trạng thái</th>
                            <th class="text-end">Thao tác</th>
                          </tr>
                        </thead>
                        <tbody id="goalsTableBody"></tbody>
                      </table>
                    </div>
                  </div>
                </div>

                <div class="col-12">
                  <div class="card p-3">
                    <div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-2">
                      <h6 class="mb-0">Theo dõi thói quen</h6>
                      <span class="small text-muted">Điểm danh sẽ khóa khi đạt quota của kỳ</span>
                    </div>
                    <div class="table-responsive">
                      <table class="table align-middle tx-table" id="habitsTable">
                        <thead>
                          <tr>
                            <th>Thói quen</th>
                            <th>Chu kỳ</th>
                            <th>Mục tiêu</th>
                            <th>Tiến độ kỳ</th>
                            <th>Trạng thái</th>
                            <th class="text-end">Thao tác</th>
                          </tr>
                        </thead>
                        <tbody id="habitsTableBody"></tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </section>

            <section id="video-plan" class="route">
              <div class="page-header video-plan-header">
                <div>
                  <h4 class="mb-1" id="videoPlanTitle">Kế hoạch video YouTube</h4>
                  <p class="text-muted small mb-0" id="videoPlanSubtitle">
                    Vận hành lịch sản xuất nội dung theo 6 giai đoạn rõ ràng và dễ theo dõi.
                  </p>
                </div>
              </div>

              <div class="card p-3 mb-3 video-plan-create-card">
                <div class="video-block-head mb-3">
                  <h6 class="mb-1" id="videoCreateTitle">Tạo nhanh công việc video</h6>
                  <p class="small text-muted mb-0" id="videoCreateSubtitle">
                    Điền thông tin cốt lõi, sau đó dùng AI hoặc template để hoàn thiện nội dung.
                  </p>
                </div>
                <div class="row g-3 video-plan-form-grid">
                  <div class="col-12 col-md-6 col-xl-4">
                    <label class="form-label">Tiêu đề video</label>
                    <input id="videoTitle" class="form-control" placeholder="Ví dụ: Thiết lập ngân sách 2026" />
                  </div>
                  <div class="col-6 col-md-3 col-xl-2">
                    <label class="form-label">Hạn chót</label>
                    <input id="videoDeadline" type="date" class="form-control" />
                  </div>
                  <div class="col-6 col-md-3 col-xl-2">
                    <label class="form-label">Ưu tiên</label>
                    <select id="videoPriority" class="form-select">
                      <option value="low">Thấp</option>
                      <option value="medium" selected>Vừa</option>
                      <option value="high">Cao</option>
                    </select>
                  </div>
                  <div class="col-6 col-md-3 col-xl-2">
                    <label class="form-label" for="videoType">Định dạng</label>
                    <select id="videoType" class="form-select">
                      <option value="short" selected>Video ngắn 30s</option>
                      <option value="long">Video dài 5-10 phút</option>
                    </select>
                  </div>
                  <div class="col-12 col-md-6 col-xl-4">
                    <label class="form-label">Liên kết kịch bản</label>
                    <input id="videoScriptUrl" class="form-control" placeholder="Liên kết tài liệu kịch bản" />
                  </div>
                  <div class="col-12 col-md-6">
                    <label class="form-label">Danh sách cảnh quay</label>
                    <textarea id="videoShotList" class="form-control" rows="2" placeholder="- Mở đầu 10 giây&#10;- Các ý chính"></textarea>
                  </div>
                  <div class="col-12 col-md-6">
                    <label class="form-label">Liên kết tài nguyên</label>
                    <textarea id="videoAssetLinks" class="form-control" rows="2" placeholder="Mỗi link một dòng hoặc cách nhau bằng dấu phẩy"></textarea>
                  </div>
                  <div class="col-12">
                    <label class="form-label">Ghi chú</label>
                    <textarea id="videoNote" class="form-control" rows="2" placeholder="Yêu cầu ảnh bìa, lời kêu gọi hành động, ý tưởng mở rộng..."></textarea>
                  </div>
                  <div class="col-12 d-flex flex-wrap justify-content-end gap-2 align-items-center video-form-actions">
                    <div class="d-flex align-items-center gap-2">
                      <label class="form-label mb-0 small" for="videoAiLanguage">Trọng tâm AI</label>
                      <select id="videoAiLanguage" class="form-select form-select-sm">
                        <option value="python" selected>Python</option>
                        <option value="javascript">JavaScript</option>
                        <option value="frontend">Frontend thực chiến</option>
                        <option value="backend">Backend thực chiến</option>
                        <option value="data_ai">Data/AI ứng dụng</option>
                        <option value="automation">Tự động hóa thực tế</option>
                        <option value="mobile">Mobile app cơ bản</option>
                        <option value="system_design">System design nhập môn</option>
                      </select>
                    </div>
                    <button class="btn btn-outline-primary" id="btnVideoAiGenerate" type="button">AI gợi ý mới</button>
                    <button class="btn btn-outline-secondary" id="btnVideoAiImprove" type="button">AI cải thiện nội dung</button>
                    <button class="btn btn-primary" id="btnAddVideoTask" type="button">Thêm công việc video</button>
                  </div>
                </div>
                <div id="videoAiSuggestionList" class="ai-suggestion-list mt-3"></div>
                <div class="card p-2 mt-3 border-0 bg-light-subtle video-blueprint-card">
                  <div class="row g-2 align-items-end">
                    <div class="col-12 col-md-4">
                      <label class="form-label mb-1" for="videoBlueprintType">Loại template</label>
                      <select id="videoBlueprintType" class="form-select form-select-sm">
                        <option value="short" selected>Video ngắn 30s</option>
                        <option value="long">Video dài 5-10 phút</option>
                      </select>
                    </div>
                    <div class="col-12 col-md-5">
                      <label class="form-label mb-1" for="videoBlueprintSelect">Template nội dung</label>
                      <select id="videoBlueprintSelect" class="form-select form-select-sm">
                        <option value="">Chọn mẫu nội dung</option>
                      </select>
                    </div>
                    <div class="col-12 col-md-3 d-grid d-md-flex gap-2">
                      <button class="btn btn-outline-primary btn-sm w-100" id="btnVideoApplyBlueprint" type="button">Áp dụng template</button>
                      <button class="btn btn-outline-secondary btn-sm w-100" id="btnVideoSaveBlueprint" type="button">Lưu template</button>
                    </div>
                  </div>
                </div>
              </div>

              <div class="card p-3 mb-3 video-plan-filter-card">
                <div class="video-block-head mb-2">
                  <h6 class="mb-1" id="videoFilterTitle">Bộ lọc và điều hướng</h6>
                  <p class="small text-muted mb-0" id="videoFilterSubtitle">
                    Lọc theo giai đoạn, ưu tiên, trạng thái kết quả và từ khóa.
                  </p>
                </div>
                <div class="video-filter-grid">
                  <div class="video-filter-item">
                    <label class="form-label">Lọc theo giai đoạn</label>
                    <select id="videoFilterStage" class="form-select form-select-sm">
                      <option value="all">Tất cả giai đoạn</option>
                      <option value="idea">Ý tưởng</option>
                      <option value="research">Nghiên cứu</option>
                      <option value="script">Kịch bản</option>
                      <option value="shoot">Quay</option>
                      <option value="edit">Dựng</option>
                      <option value="publish">Xuất bản</option>
                    </select>
                  </div>
                  <div class="video-filter-item">
                    <label class="form-label">Lọc theo ưu tiên</label>
                    <select id="videoFilterPriority" class="form-select form-select-sm">
                      <option value="all">Tất cả ưu tiên</option>
                      <option value="low">Thấp</option>
                      <option value="medium">Vừa</option>
                      <option value="high">Cao</option>
                    </select>
                  </div>
                  <div class="video-filter-item">
                    <label class="form-label" for="videoRetroFilter">Trạng thái kết quả</label>
                    <select id="videoRetroFilter" class="form-select form-select-sm">
                      <option value="all">Tất cả</option>
                      <option value="withRetro">Đã ghi kết quả</option>
                      <option value="withoutRetro">Chưa ghi kết quả</option>
                    </select>
                  </div>
                  <div class="video-filter-item video-filter-query">
                    <label class="form-label">Tìm nhanh</label>
                    <input id="videoFilterQuery" class="form-control form-control-sm" placeholder="Tìm theo tiêu đề hoặc ghi chú..." />
                  </div>
                  <div class="video-filter-actions">
                    <button class="btn btn-outline-secondary btn-sm" id="btnVideoFilterReset" type="button">Đặt lại</button>
                  </div>
                </div>
                <div class="small text-muted mt-2" id="videoFilterSummary"></div>
              </div>

              <div class="card p-3 mb-3 video-plan-view-switch">
                <div class="d-flex flex-wrap align-items-center justify-content-between gap-2 video-view-toolbar">
                  <div class="small fw-semibold text-body-secondary" id="videoViewModeLabel">Chế độ hiển thị</div>
                  <div class="btn-group btn-group-sm" role="group" aria-label="Chuyển chế độ hiển thị video">
                    <button class="btn btn-outline-primary active" id="videoViewBoard" type="button" aria-pressed="true">
                      Bảng
                    </button>
                    <button class="btn btn-outline-primary" id="videoViewCalendar" type="button" aria-pressed="false">
                      Lịch
                    </button>
                  </div>
                  <div class="small text-muted" id="videoCalendarSelectedLabel">Lịch ngày hôm nay</div>
                </div>
              </div>

              <div id="videoPlanViewBoard">
                <div class="video-board">
                  <article class="video-stage">
                    <header>Ý tưởng</header>
                    <div class="video-stage-body" id="videoColIdea" data-stage="idea"></div>
                  </article>
                  <article class="video-stage">
                    <header>Nghiên cứu</header>
                    <div class="video-stage-body" id="videoColResearch" data-stage="research"></div>
                  </article>
                  <article class="video-stage">
                    <header>Kịch bản</header>
                    <div class="video-stage-body" id="videoColScript" data-stage="script"></div>
                  </article>
                  <article class="video-stage">
                    <header>Quay</header>
                    <div class="video-stage-body" id="videoColShoot" data-stage="shoot"></div>
                  </article>
                  <article class="video-stage">
                    <header>Dựng</header>
                    <div class="video-stage-body" id="videoColEdit" data-stage="edit"></div>
                  </article>
                  <article class="video-stage">
                    <header>Xuất bản</header>
                    <div class="video-stage-body" id="videoColPublish" data-stage="publish"></div>
                  </article>
                </div>
              </div>

              <div id="videoPlanViewCalendar" class="d-none">
                <div class="card p-3 mb-3 video-calendar-shell">
                  <div class="video-calendar-head d-flex flex-wrap align-items-center justify-content-between gap-2">
                    <div class="btn-group btn-group-sm" role="group" aria-label="Điều hướng tháng lịch video">
                      <button class="btn btn-outline-secondary" id="btnVideoCalPrevMonth" type="button">&lt;</button>
                      <button class="btn btn-outline-secondary" id="btnVideoCalToday" type="button">Hôm nay</button>
                      <button class="btn btn-outline-secondary" id="btnVideoCalNextMonth" type="button">&gt;</button>
                    </div>
                    <strong id="videoCalendarMonthLabel">Tháng hiện tại</strong>
                    <div id="videoCalendarLegend" class="video-calendar-legend"></div>
                  </div>

                  <div id="videoCalendarWeekStrip" class="video-calendar-week-strip mt-3"></div>
                  <div id="videoCalendarGrid" class="video-calendar-grid mt-2"></div>
                </div>

                <div class="row g-3">
                  <div class="col-12 col-xl-8">
                    <div class="card p-3 h-100">
                      <div class="d-flex justify-content-between align-items-center gap-2 mb-2">
                        <h6 class="mb-0" id="videoCalendarAgendaTitle">Lịch theo ngày</h6>
                        <a href="#video-plan" class="small text-decoration-none" id="videoCalendarOpenBoardLink">Mở bảng video</a>
                      </div>
                      <div id="videoCalendarAgenda" class="video-calendar-agenda"></div>
                    </div>
                  </div>
                  <div class="col-12 col-xl-4">
                    <div class="card p-3 h-100">
                      <h6 class="mb-2" id="videoCalendarUnscheduledTitle">Chưa lên lịch</h6>
                      <div id="videoUnscheduledList" class="video-unscheduled-list"></div>
                    </div>
                  </div>
                </div>
              </div>
            </section>
            <section id="accounts" class="route">
              <div class="page-header">
                <div>
                  <h4 class="mb-1">Tài khoản &amp; Thu nhập</h4>
                  <p class="text-muted small mb-0">
                    Quản lý ví/tài khoản, luồng tiền vào và chuyển khoản nội bộ.
                  </p>
                </div>
                <div class="page-actions">
                  <button class="btn btn-outline-primary" data-bs-toggle="offcanvas" data-bs-target="#transferModal">
                    Chuyển tiền
                  </button>
                  <button class="btn btn-outline-primary" data-bs-toggle="offcanvas" data-bs-target="#addIncomeModal">
                    + Thêm thu nhập
                  </button>
                  <button class="btn btn-primary" data-bs-toggle="offcanvas" data-bs-target="#addAccountModal">
                    + Thêm tài khoản
                  </button>
                </div>
              </div>

              <div class="row g-3">
                <div class="col-12 col-xxl-7">
                  <div class="card p-3">
                    <div class="d-flex flex-wrap gap-2 align-items-center justify-content-between mb-2">
                      <h6 class="mb-0">Thu nhập theo tháng</h6>
                      <div class="d-flex flex-wrap gap-2 income-actions">
                        <select id="incomeMonthFilter" class="form-select form-select-sm"></select>
                        <select id="incomeAccountFilter" class="form-select form-select-sm">
                          <option value="all">Tất cả tài khoản</option>
                        </select>
                        <input
                          id="incomeSearch"
                          type="search"
                          class="form-control form-control-sm"
                          placeholder="Tìm theo tên hoặc ghi chú"
                        />
                      </div>
                    </div>
                    <div id="incomeFilterInfo" class="text-muted small mb-2"></div>
                    <div class="table-responsive">
                      <table class="table align-middle tx-table tx-table-mobile" id="incomesTable">
                        <thead>
                          <tr>
                            <th>Ngày</th>
                            <th>Giao dịch</th>
                            <th>Tài khoản</th>
                            <th class="text-end">Số tiền</th>
                            <th class="text-end">Thao tác</th>
                          </tr>
                        </thead>
                        <tbody></tbody>
                      </table>
                    </div>
                  </div>
                </div>

                <div class="col-12 col-xxl-5">
                  <div class="card p-3 mb-3">
                    <h6 class="mb-2">Danh sách tài khoản</h6>
                    <div class="table-responsive">
                      <table class="table align-middle" id="accountsTable">
                        <thead>
                          <tr>
                            <th>Tài khoản</th>
                            <th>Loại</th>
                            <th>Trạng thái</th>
                            <th class="text-end">Thao tác</th>
                          </tr>
                        </thead>
                        <tbody></tbody>
                      </table>
                    </div>
                  </div>

                  <div class="card p-3">
                    <h6 class="mb-2">Số dư toàn bộ tài khoản</h6>
                    <div id="balanceList" class="small">
                      <div class="text-muted">Chưa có dữ liệu</div>
                    </div>
                  </div>
                </div>
              </div>
            </section>

            <section id="settings" class="route">
              <div class="page-header">
                <div>
                  <h4 class="mb-1">Cài đặt</h4>
                  <p class="text-muted small mb-0">Tùy chỉnh trải nghiệm làm việc cá nhân trong NEXUS OS.</p>
                </div>
                <div class="small text-muted fw-medium" id="stSaveStatus">Thay đổi sẽ tự động lưu</div>
              </div>

              <div class="card p-3 p-md-4 settings-card">
                <ul class="nav nav-tabs settings-tabs" id="settingsTabs" role="tablist">
                  <li class="nav-item" role="presentation">
                    <button
                      class="nav-link active"
                      id="settings-tab-profile"
                      data-bs-toggle="tab"
                      data-bs-target="#settingsPaneProfile"
                      type="button"
                      role="tab"
                      aria-controls="settingsPaneProfile"
                      aria-selected="true"
                    >
                      <span id="stTabProfile">Hồ sơ cá nhân</span>
                    </button>
                  </li>
                  <li class="nav-item" role="presentation">
                    <button
                      class="nav-link"
                      id="settings-tab-dashboard"
                      data-bs-toggle="tab"
                      data-bs-target="#settingsPaneDashboard"
                      type="button"
                      role="tab"
                      aria-controls="settingsPaneDashboard"
                      aria-selected="false"
                    >
                      <span id="stTabDashboard">Tùy chọn Dashboard</span>
                    </button>
                  </li>
                  <li class="nav-item" role="presentation">
                    <button
                      class="nav-link"
                      id="settings-tab-filters"
                      data-bs-toggle="tab"
                      data-bs-target="#settingsPaneFilters"
                      type="button"
                      role="tab"
                      aria-controls="settingsPaneFilters"
                      aria-selected="false"
                    >
                      <span id="stTabFilters">Bộ lọc &amp; Hiển thị</span>
                    </button>
                  </li>
                </ul>

                <div class="tab-content settings-tab-content mt-3">
                  <div
                    class="tab-pane fade show active"
                    id="settingsPaneProfile"
                    role="tabpanel"
                    aria-labelledby="settings-tab-profile"
                    tabindex="0"
                  >
                    <div class="settings-section-head mb-3">
                      <h6 class="mb-1" id="stProfileTitle">Hồ sơ cá nhân</h6>
                      <p class="text-muted small mb-0" id="stProfileSub">
                        Thông tin này ảnh hưởng trực tiếp đến dashboard cá nhân hóa.
                      </p>
                    </div>
                    <div class="row g-3">
                      <div class="col-12 col-lg-6">
                        <label class="form-label" id="stLabelDisplayName" for="stDisplayName">Tên hiển thị</label>
                        <input type="text" class="form-control" id="stDisplayName" />
                      </div>
                      <div class="col-12 col-lg-6">
                        <label class="form-label" id="stLabelTagline" for="stTagline">Tagline</label>
                        <input type="text" class="form-control" id="stTagline" />
                      </div>
                      <div class="col-12">
                        <label class="form-label" id="stLabelMissionDefault" for="stMissionDefault">
                          Nhiệm vụ mặc định
                        </label>
                        <textarea class="form-control" id="stMissionDefault" rows="3"></textarea>
                      </div>
                    </div>
                  </div>

                  <div
                    class="tab-pane fade"
                    id="settingsPaneDashboard"
                    role="tabpanel"
                    aria-labelledby="settings-tab-dashboard"
                    tabindex="0"
                  >
                    <div class="settings-section-head mb-3">
                      <h6 class="mb-1" id="stDashboardTitle">Tùy chọn Dashboard</h6>
                    </div>
                    <div class="row g-3">
                      <div class="col-12 col-md-4">
                        <label class="form-label" id="stLabelNextActionsMax" for="stNextActionsMax">
                          Số việc kế tiếp hiển thị
                        </label>
                        <input type="number" min="1" max="6" class="form-control" id="stNextActionsMax" />
                      </div>
                      <div class="col-12 col-md-4">
                        <label class="form-label" id="stLabelDeadlineWindowHours" for="stDeadlineWindowHours">
                          Khung giờ cảnh báo cận hạn
                        </label>
                        <input type="number" min="12" max="336" step="1" class="form-control" id="stDeadlineWindowHours" />
                      </div>
                      <div class="col-12 col-md-4">
                        <label class="form-label" id="stLabelStartRoute" for="stStartRoute">
                          Route mặc định sau đăng nhập
                        </label>
                        <select class="form-select" id="stStartRoute">
                          <option value="dashboard" id="stOptStartDashboard">Trung tâm</option>
                          <option value="goals" id="stOptStartGoals">Mục tiêu</option>
                          <option value="video-plan" id="stOptStartVideoPlan">Kế hoạch video</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <div
                    class="tab-pane fade"
                    id="settingsPaneFilters"
                    role="tabpanel"
                    aria-labelledby="settings-tab-filters"
                    tabindex="0"
                  >
                    <div class="settings-section-head mb-3">
                      <h6 class="mb-1" id="stFiltersTitle">Bộ lọc &amp; Hiển thị</h6>
                    </div>
                    <div class="row g-3">
                      <div class="col-12 col-md-6">
                        <label class="form-label" id="stLabelMonthMode" for="stMonthMode">Chế độ tháng mặc định</label>
                        <select class="form-select" id="stMonthMode">
                          <option value="current" id="stOptMonthCurrent">Luôn về tháng hiện tại</option>
                          <option value="lastUsed" id="stOptMonthLastUsed">Nhớ tháng đã dùng gần nhất</option>
                        </select>
                      </div>
                      <div class="col-12 col-md-6">
                        <label class="form-label" id="stLabelUiDensity" for="stUiDensity">Mật độ giao diện</label>
                        <select class="form-select" id="stUiDensity">
                          <option value="comfortable" id="stOptDensityComfortable">Thoải mái</option>
                          <option value="compact" id="stOptDensityCompact">Gọn</option>
                        </select>
                      </div>
                      <div class="col-12">
                        <div class="settings-switches">
                          <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="stRememberExpenseFilters" />
                            <label class="form-check-label" id="stLabelRememberExpenseFilters" for="stRememberExpenseFilters">
                              Nhớ bộ lọc Chi tiêu
                            </label>
                          </div>
                          <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="stRememberIncomeFilters" />
                            <label class="form-check-label" id="stLabelRememberIncomeFilters" for="stRememberIncomeFilters">
                              Nhớ bộ lọc Thu nhập
                            </label>
                          </div>
                          <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="stRememberVideoFilters" />
                            <label class="form-check-label" id="stLabelRememberVideoFilters" for="stRememberVideoFilters">
                              Nhớ bộ lọc Video
                            </label>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </section>
          </div>
        </main>
      </div>
    </div>

    <div class="offcanvas offcanvas-end panel" id="editVideoTaskModal" tabindex="-1">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title">Chỉnh sửa công việc video</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <input type="hidden" id="evId" />
        <div class="row g-3">
          <div class="col-12">
            <label class="form-label">Tiêu đề video</label>
            <input id="evTitle" class="form-control" placeholder="Ví dụ: Thiết lập ngân sách 2026" />
          </div>
          <div class="col-6">
            <label class="form-label">Hạn chót</label>
            <input id="evDeadline" type="date" class="form-control" />
          </div>
          <div class="col-6">
            <label class="form-label">Ưu tiên</label>
            <select id="evPriority" class="form-select">
              <option value="low">Thấp</option>
              <option value="medium" selected>Vừa</option>
              <option value="high">Cao</option>
            </select>
          </div>
          <div class="col-12">
            <label class="form-label">Liên kết kịch bản</label>
            <input id="evScriptUrl" class="form-control" placeholder="Liên kết tài liệu kịch bản" />
          </div>
          <div class="col-12">
            <label class="form-label">Danh sách cảnh quay</label>
            <textarea id="evShotList" class="form-control" rows="2" placeholder="- Mở đầu 10 giây&#10;- Các ý chính"></textarea>
          </div>
          <div class="col-12">
            <label class="form-label">Liên kết tài nguyên</label>
            <textarea id="evAssetLinks" class="form-control" rows="2" placeholder="Mỗi link một dòng hoặc cách nhau bằng dấu phẩy"></textarea>
          </div>
          <div class="col-12">
            <label class="form-label">Ghi chú</label>
            <textarea id="evNote" class="form-control" rows="2" placeholder="Yêu cầu ảnh bìa, lời kêu gọi hành động, ý tưởng mở rộng..."></textarea>
          </div>
        </div>
        <div class="panel-footer">
          <button class="btn btn-outline-secondary" data-bs-dismiss="offcanvas">Đóng</button>
          <button class="btn btn-primary" id="btnSaveVideoTask">Lưu thay đổi</button>
        </div>
      </div>
    </div>

    <div class="offcanvas offcanvas-end panel" id="videoRetroPanel" tabindex="-1">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title">Kết quả xuất bản</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <input type="hidden" id="vrTaskId" />
        <div class="small text-muted mb-2" id="vrTaskTitle"></div>
        <div class="row g-3">
          <div class="col-12 col-md-6">
            <label class="form-label" for="vrPublishedAt">Ngày xuất bản</label>
            <input id="vrPublishedAt" type="date" class="form-control" />
          </div>
          <div class="col-12 col-md-6">
            <label class="form-label" for="vrDurationSec">Thời lượng (giây)</label>
            <input id="vrDurationSec" type="number" min="0" class="form-control" />
          </div>
          <div class="col-12 col-md-6">
            <label class="form-label" for="vrViews">Lượt xem</label>
            <input id="vrViews" type="number" min="0" class="form-control" />
          </div>
          <div class="col-12 col-md-6">
            <label class="form-label" for="vrCtr">CTR (%)</label>
            <input id="vrCtr" type="number" min="0" step="0.01" class="form-control" />
          </div>
          <div class="col-12">
            <label class="form-label" for="vrRetention30s">Retention 30s (%)</label>
            <input id="vrRetention30s" type="number" min="0" step="0.01" class="form-control" />
          </div>
          <div class="col-12">
            <label class="form-label" for="vrNote">Ghi chú rút kinh nghiệm</label>
            <textarea id="vrNote" class="form-control" rows="3"></textarea>
          </div>
        </div>
        <div class="panel-footer">
          <button class="btn btn-outline-secondary" data-bs-dismiss="offcanvas">Đóng</button>
          <button class="btn btn-primary" id="btnVideoRetroSave">Lưu kết quả</button>
        </div>
      </div>
    </div>

    <div class="offcanvas offcanvas-end panel" id="addExpenseModal" tabindex="-1">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title">Thêm khoản chi</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <div class="alert alert-danger d-none" id="aeError"></div>
        <div class="row g-3">
          <div class="col-12">
            <label class="form-label">Tên giao dịch</label>
            <input type="text" class="form-control" id="eName" placeholder="Ăn trưa, cà phê, thuê nhà..." />
          </div>
          <div class="col-6">
            <label class="form-label">Số tiền</label>
            <input type="number" class="form-control" id="eAmount" placeholder="0" />
          </div>
          <div class="col-6">
            <label class="form-label">Ngày</label>
            <input type="date" class="form-control" id="eDate" />
          </div>
          <div class="col-6">
            <label class="form-label">Danh mục</label>
            <select class="form-select" id="eCategory">
              <option value="Food & Drink">Ăn uống</option>
              <option value="Coffee">Cà phê</option>
              <option value="Personal">Cá nhân</option>
              <option value="Rent">Nhà ở</option>
              <option value="Fitness">Thể thao</option>
              <option value="Groceries">Đi chợ</option>
              <option value="Transport">Di chuyển</option>
              <option value="Healthcare">Sức khỏe</option>
              <option value="Lending">Cho vay</option>
              <option value="Other" selected>Khác</option>
            </select>
          </div>
          <div class="col-6">
            <label class="form-label">Tài khoản</label>
            <select class="form-select" id="eAccount"></select>
          </div>
          <div class="col-12">
            <div class="ai-inline-hint d-none" id="expenseAiHint"></div>
            <button class="btn btn-sm btn-outline-primary d-none mt-2" id="btnExpenseAiApply" type="button">
              Áp dụng đề xuất AI
            </button>
          </div>
          <div class="col-12">
            <label class="form-label">Ghi chú</label>
            <textarea class="form-control" id="eNote" rows="2" placeholder="Không bắt buộc"></textarea>
          </div>
        </div>
        <div class="panel-footer">
          <button class="btn btn-outline-secondary" data-bs-dismiss="offcanvas">Đóng</button>
          <button class="btn btn-primary" id="btnAddExpense">Lưu khoản chi</button>
        </div>
      </div>
    </div>

    <div class="offcanvas offcanvas-end panel" id="editExpenseModal" tabindex="-1">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title">Chỉnh sửa khoản chi</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <input type="hidden" id="edId" />
        <div class="row g-3">
          <div class="col-12">
            <label class="form-label">Tên giao dịch</label>
            <input id="edName" class="form-control" />
          </div>
          <div class="col-6">
            <label class="form-label">Số tiền</label>
            <input id="edAmount" type="number" class="form-control" />
          </div>
          <div class="col-6">
            <label class="form-label">Ngày</label>
            <input id="edDate" type="date" class="form-control" />
          </div>
          <div class="col-6">
            <label class="form-label">Danh mục</label>
            <select id="edCategory" class="form-select">
              <option value="Food & Drink">Ăn uống</option>
              <option value="Coffee">Cà phê</option>
              <option value="Personal">Cá nhân</option>
              <option value="Rent">Nhà ở</option>
              <option value="Fitness">Thể thao</option>
              <option value="Groceries">Đi chợ</option>
              <option value="Transport">Di chuyển</option>
              <option value="Healthcare">Sức khỏe</option>
              <option value="Lending">Cho vay</option>
              <option value="Other">Khác</option>
            </select>
          </div>
          <div class="col-6">
            <label class="form-label">Tài khoản</label>
            <select id="edAccount" class="form-select"></select>
          </div>
          <div class="col-12">
            <label class="form-label">Ghi chú</label>
            <textarea id="edNote" class="form-control" rows="2"></textarea>
          </div>
        </div>
        <div class="panel-footer">
          <button class="btn btn-outline-secondary" data-bs-dismiss="offcanvas">Đóng</button>
          <button class="btn btn-primary" id="btnSaveExpense">Lưu thay đổi</button>
        </div>
      </div>
    </div>
    <div class="offcanvas offcanvas-end panel" id="addIncomeModal" tabindex="-1">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title">Thêm khoản thu</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">Tên giao dịch</label>
            <input class="form-control" id="iName" placeholder="Lương, bonus, hoàn tiền..." />
          </div>
          <div class="col-md-3">
            <label class="form-label">Số tiền</label>
            <input class="form-control" id="iAmount" type="number" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Ngày</label>
            <input class="form-control" id="iDate" type="date" />
          </div>
          <div class="col-md-6">
            <label class="form-label">Tài khoản</label>
            <select class="form-select" id="iAccount"></select>
          </div>
          <div class="col-12">
            <label class="form-label">Ghi chú</label>
            <textarea class="form-control" id="iNote" rows="2"></textarea>
          </div>
        </div>
        <div class="panel-footer">
          <button class="btn btn-outline-secondary" data-bs-dismiss="offcanvas">Đóng</button>
          <button class="btn btn-primary" id="btnAddIncome">Lưu khoản thu</button>
        </div>
      </div>
    </div>

    <div class="offcanvas offcanvas-end panel" id="editIncomeModal" tabindex="-1">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title">Chỉnh sửa khoản thu</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <input type="hidden" id="eiId" />
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">Tên giao dịch</label>
            <input class="form-control" id="eiName" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Số tiền</label>
            <input class="form-control" id="eiAmount" type="number" />
          </div>
          <div class="col-md-3">
            <label class="form-label">Ngày</label>
            <input class="form-control" id="eiDate" type="date" />
          </div>
          <div class="col-md-6">
            <label class="form-label">Tài khoản</label>
            <select class="form-select" id="eiAccount"></select>
          </div>
          <div class="col-12">
            <label class="form-label">Ghi chú</label>
            <textarea class="form-control" id="eiNote" rows="2"></textarea>
          </div>
        </div>
        <div class="panel-footer">
          <button class="btn btn-outline-secondary" data-bs-dismiss="offcanvas">Đóng</button>
          <button class="btn btn-primary" id="btnSaveIncome">Lưu thay đổi</button>
        </div>
      </div>
    </div>

    <div class="offcanvas offcanvas-end panel" id="addAccountModal" tabindex="-1">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title">Thêm tài khoản mới</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <div class="mb-2">
          <label class="form-label">Tên tài khoản</label>
          <input class="form-control" id="aName" placeholder="Tên ngân hàng hoặc ví" />
        </div>
        <div class="mb-2">
          <label class="form-label">Loại</label>
          <select class="form-select" id="aType">
            <option value="bank">Ngân hàng</option>
            <option value="ewallet">Ví điện tử</option>
            <option value="other">Khác</option>
          </select>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="aDefault" />
          <label class="form-check-label" for="aDefault">Đặt làm mặc định</label>
        </div>
        <div class="panel-footer">
          <button class="btn btn-outline-secondary" data-bs-dismiss="offcanvas">Đóng</button>
          <button class="btn btn-primary" id="btnAddAccount">Tạo tài khoản</button>
        </div>
      </div>
    </div>

    <div class="offcanvas offcanvas-end panel" id="editAccountModal" tabindex="-1">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title">Chỉnh sửa tài khoản</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <input type="hidden" id="eaId" />
        <div class="mb-2">
          <label class="form-label">Tên tài khoản</label>
          <input class="form-control" id="eaName" />
        </div>
        <div class="mb-2">
          <label class="form-label">Loại</label>
          <select class="form-select" id="eaType">
            <option value="bank">Ngân hàng</option>
            <option value="ewallet">Ví điện tử</option>
            <option value="other">Khác</option>
          </select>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="eaDefault" />
          <label class="form-check-label" for="eaDefault">Đặt làm mặc định</label>
        </div>
        <div class="panel-footer">
          <button class="btn btn-outline-secondary" data-bs-dismiss="offcanvas">Đóng</button>
          <button class="btn btn-primary" id="btnSaveAccount">Lưu thay đổi</button>
        </div>
      </div>
    </div>

    <div class="offcanvas offcanvas-end panel" id="deleteAccountModal" tabindex="-1">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title">Xóa tài khoản</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <input type="hidden" id="daId" />
        <p class="text-muted">Tất cả giao dịch sẽ được chuyển sang tài khoản khác.</p>
        <div class="mb-3">
          <label class="form-label">Chuyển dữ liệu sang</label>
          <select class="form-select" id="daTarget"></select>
        </div>
        <div class="panel-footer">
          <button class="btn btn-outline-secondary" data-bs-dismiss="offcanvas">Hủy</button>
          <button class="btn btn-danger" id="btnConfirmDeleteAccount">Xóa tài khoản</button>
        </div>
      </div>
    </div>

    <div class="offcanvas offcanvas-end panel" id="transferModal" tabindex="-1">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title">Chuyển tiền giữa các tài khoản</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <div class="row g-3">
          <div class="col-12">
            <label class="form-label">Từ</label>
            <select class="form-select" id="tfFrom"></select>
          </div>
          <div class="col-12">
            <label class="form-label">Đến</label>
            <select class="form-select" id="tfTo"></select>
          </div>
          <div class="col-6">
            <label class="form-label">Số tiền</label>
            <input class="form-control" id="tfAmount" type="number" />
          </div>
          <div class="col-6">
            <label class="form-label">Ngày</label>
            <input class="form-control" id="tfDate" type="date" />
          </div>
          <div class="col-12">
            <label class="form-label">Ghi chú</label>
            <textarea class="form-control" id="tfNote" rows="2"></textarea>
          </div>
        </div>
        <div class="panel-footer">
          <button class="btn btn-outline-secondary" data-bs-dismiss="offcanvas">Hủy</button>
          <button class="btn btn-primary" id="btnDoTransfer">Chuyển tiền</button>
        </div>
      </div>
    </div>

    <div class="offcanvas offcanvas-end panel" id="confirmDeleteModal" tabindex="-1">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="confirmDeleteTitle">Xác nhận xóa</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <p class="mb-3" id="confirmDeleteText">Hành động này không thể hoàn tác.</p>
        <div class="panel-footer">
          <button class="btn btn-outline-secondary" data-bs-dismiss="offcanvas">Hủy</button>
          <button class="btn btn-danger" id="btnConfirmDelete">Xóa</button>
        </div>
      </div>
    </div>

    <div id="appLoading" aria-live="polite" aria-hidden="true">
      <div class="loading-card d-flex align-items-center gap-2">
        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        <span class="small">Đang tải dữ liệu...</span>
      </div>
    </div>

    <div class="toast-container position-fixed bottom-0 end-0 p-3">
      <div
        id="appToast"
        class="toast align-items-center border-0"
        role="status"
        aria-live="polite"
        aria-atomic="true"
      >
        <div class="d-flex">
          <div class="toast-body"></div>
          <button
            type="button"
            class="btn-close me-2 m-auto"
            data-bs-dismiss="toast"
            aria-label="Đóng"
          ></button>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="/src/main.js"></script>

  </body>
</html>
